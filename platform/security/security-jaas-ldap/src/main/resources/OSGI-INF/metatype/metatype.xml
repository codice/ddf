<!--
/**
 * Copyright (c) Codice Foundation
 *
 * This is free software: you can redistribute it and/or modify it under the terms of the GNU Lesser General Public License as published by the Free Software Foundation, either
 * version 3 of the License, or any later version. 
 *
 * This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
 * See the GNU Lesser General Public License for more details. A copy of the GNU Lesser General Public License is distributed along with this program and can be found at
 * <http://www.gnu.org/licenses/lgpl.html>.
 *
 **/
-->
<metatype:MetaData xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xmlns:metatype="http://www.osgi.org/xmlns/metatype/v1.2.0"
                   xsi:schemaLocation="http://www.osgi.org/xmlns/metatype/v1.2.0 http://www.osgi.org/xmlns/metatype/v1.2.0">

	<OCD description="STS Ldap Login Configuration" name="Security STS LDAP Login"
         id="Ldap_Login_Config">
	    
	    <AD name="LDAP URL:" id="ldapUrl" required="true" type="String" cardinality="10"
            default="ldaps://${org.codice.ddf.system.hostname}:1636"
            description="LDAP or LDAPS server and port">
	    </AD>

		<AD name="LDAP Load Balancing:" id="ldapLoadBalancing" required="false" type="String"
			default="round_robin"
			description="Load balancing algorithm to use when multiple LDAP urls are provided (round_robin, failover)">
		</AD>

		<AD name="LDAP Bind Method" id="bindMethod" required="true" type="String"
			default="Simple">
			<Option label="Digest MD5 SASL" value="Digest MD5 SASL" />
			<Option label="GSSAPI SASL" value="GSSAPI SASL" />
			<Option label="SASL" value="SASL" />
			<Option label="Simple" value="Simple" />
		</AD>

		<AD name="Realm (GSSAPI and Digest MD5 SASL only):" id="realm" required="false" type="String"
			default=""
			description="Realm to use during bind. This applies only to Kerberos and Digest MD5 authentication.">
		</AD>

		<AD name="KDC Address (GSSAPI SASL only):" id="kdcAddress" required="false" type="String"
			default=""
			description="KDC address to use during bind. This applies only to Kerberos authentication.">
		</AD>

        <AD name="StartTLS:" id="startTls" required="true" type="Boolean"
            default="false"
            description="Determines whether or not to use StartTLS when connecting via the ldap protocol. This setting is ignored if the URL uses ldaps.">
        </AD>
	    
	    <AD name="LDAP Bind User DN:" id="ldapBindUserDn" required="true" type="String"
            default="cn=admin"
            description="DN of the user to bind with LDAP. This user should have the ability to verify passwords and read attributes for any user.">
	    </AD>
	    
	    <AD name="LDAP Bind User Password:" id="ldapBindUserPass" required="true" type="Password"
            default="secret"
            description="Password used to bind user with LDAP.">
	    </AD>

		<AD name="LDAP Group Membership Attribute:" id="membershipUserAttribute" required="true" type="String"
			default="uid"
			description="Attribute used as the membership attribute for the user in the group. Usually this is uid, cn, or something similar.">
		</AD>

		<AD name="LDAP Member Name Attribute:" id="memberNameAttribute" required="true" type="String"
			default="member"
			description="Attribute used to identify users in the group. Usually this is member or something similar.">
		</AD>
	    
	    <AD name="LDAP User Login Attribute:" id="loginUserAttribute" required="true" type="String"
            default="uid"
            description="Attribute used as the login username. Usually this is uid, cn, or something similar.">
	    </AD>
	    
	    <AD name="LDAP Base User DN:" id="userBaseDn" required="true" type="String"
            default="ou=users\,dc=example\,dc=com"
            description="Full LDAP path to where users can be found.">
	    </AD>
	    
	    <AD name="LDAP Base Group DN:" id="groupBaseDn" required="true" type="String"
            default="ou=groups\,dc=example\,dc=com"
            description="Full LDAP path to where groups can be found.">
	    </AD>
	    
	</OCD>
	
	<Designate factoryPid="Ldap_Login_Config" pid="Ldap_Login_Config">
	    <Object ocdref="Ldap_Login_Config"/>
  	</Designate>
  	
</metatype:MetaData>
